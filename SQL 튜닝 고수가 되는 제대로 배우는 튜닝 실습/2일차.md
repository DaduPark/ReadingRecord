heap이 이해
B트리구조 인덱스의 이해


https://dataonair.or.kr/
한국데이터 진흥원
: db관련 자격증들이 있는곳

https://dataonair.or.kr/db-tech-reference/d-guide/da-guide/
DA 가이드 : DA, SQL, DB보안 등 실무자를 위한 위한 DB기술 바이블!


------
- 시간과 읽기 수를 줄여야한다
- 하나의 테이블스페이스에는 여러개의 DBF파일로 이루어져있다
- 스키마 정의 : 계정마다의 테이블스페이스에 obJECT의 사전 정의


- 블럭
- EXTENT : 블럭들의 공간
- Segments : 테이블세그먼트와 인덱스세그먼트로 구분


-조작후 가끔 압축을 해줘야 성능이 좋아짐
--------------------
## 실습
ROWID = 페이지와 위치만 생각한다.

인덱스에는 키값과 ROWID만 들어간다

데이터가 한 파일에 4개가들어가고
인덱스는 한 파일에 5개만 들어간다고 생각하고 본다.

T1테이블(no, name, ...)2000bytes
=> 17개행을 넣는다. > 5페이지가 필요
=> 값이 랜덤으로 들어가있을 때 (힙) > table full Scan(값을 찾을때 5페이지를 스캔해야함)

제약조건 (6개)
- PK
- UK
- FK
- Not NULL
- CHECK제약
- (DEFAULT 제약)
=> 인덱스가 걸리는 제약조건 : PK, UK

힙은 조작성능(insert, update, delete)이 더 좋다
인덱스는 검색을위해 조작성능이 떨어진다

인덱스구조를 한줄로 할경우 조작할 때 db가 다운된다 -> B-tree구조 탄생

인덱스를 4페이지(17개)에 name순서에 맞춰서 쓰며 rowId(파일명, 순번)으로 나타냄-> branch 2개의 페이지에 하단의 상의 name을 가지고 만듦 > root 1페이지에 branch 상위 name을 가지고 만듦
==> no를 조건절에 건다면(where no='7') 인덱스를 안타기때문에 데이터페이지 5페이지(full)를 찾게된다.
==> name을 조건절에 건다면 인덱스를 타기때문에 인덱스페이지 3페이지+데이터펭지 1페이지 즉 4페이지만 찾게된다.
==> (where 디비<=name <=종이)로 했을경우 12개(Root-branch-leaf 3페이지 + 수평적탐색 + 데이터페이지스캔)
==> 옵티마이저가 인덱스 스캔이 많아질경우 판단하여 데이터페이지로만 확인함(full스캔)


RBO=> 규칙만 따지는 옵티마이저
CBO=> 비용만 계산하여 따지는 옵티마이저

수직적 탐색 : root-> leaf로 스캔
수평적 탐색 : leaf에서 다음것들 스캔


데이터 추가시 데이터페이지는 마지막에 추가하면 되지만 
인덱스페이지에는 leaf 레벨에 한장을 더 추가하여(페이지 스플릿_반띵) leaf(추가된 페이지과 기존 페이지를 순서에 맞게 주소값도 변경), branch등 많은 페이지들을 조정한다
=> 조회에서는 인덱스가 빠르지만 조작관점으로 보면 heap이 성능이 좋다. 그러므로 불필요한 인덱스 생성은 줄여야한다.


랜덤엑세스 : 시퀀셜엑세스가 아닌 모든것 (인덱스 랜덤엑세스, 테이블 랜덤엑세스)
시퀀셜엑세스 : 순서에 맞춰 찾아가는것(다음페이지 이전페이지 찾아가는것)

성능을 좋게하기위해선 랜덤엑세스를 줄여라 : 인덱스 랜덤엑세스가 아닌 테이블 랜덤엑세스를 줄이는것이 성능을 좋게하는 것을 뜻한다.


----
모자를 강자로 변경 실습
하마 삭제 작업 실습
